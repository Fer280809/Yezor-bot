<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel de Administración - CineWeb</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #0A0A0A 0%, #1A1A1A 100%);
            color: white;
            min-height: 100vh;
            padding: 2rem;
        }
        
        .admin-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .admin-header {
            text-align: center;
            margin-bottom: 3rem;
        }
        
        .admin-header h1 {
            font-size: 3rem;
            background: linear-gradient(135deg, #FF3366, #00D4FF);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 1rem;
        }
        
        .admin-nav {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-bottom: 3rem;
        }
        
        .admin-nav button {
            padding: 1rem 2rem;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid transparent;
            border-radius: 50px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }
        
        .admin-nav button:hover {
            background: rgba(255, 51, 102, 0.1);
            border-color: #FF3366;
        }
        
        .admin-nav button.active {
            background: linear-gradient(135deg, #FF3366, #FF6B6B);
            color: white;
        }
        
        .admin-section {
            display: none;
            animation: slideIn 0.5s ease;
        }
        
        .admin-section.active {
            display: block;
        }
        
        .admin-card {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .admin-card h3 {
            color: #FF3366;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: rgba(255, 255, 255, 0.8);
        }
        
        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            color: white;
            font-size: 1rem;
        }
        
        .form-group textarea {
            min-height: 150px;
            resize: vertical;
        }
        
        .btn-admin {
            background: linear-gradient(135deg, #FF3366, #FF6B6B);
            color: white;
            border: none;
            padding: 1rem 2.5rem;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .btn-admin:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(255, 51, 102, 0.3);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #00D4FF, #0099FF);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #00FF88, #00CC66);
        }
        
        .movies-list {
            max-height: 400px;
            overflow-y: auto;
            margin-top: 2rem;
        }
        
        .movie-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.02);
            border-radius: 12px;
            margin-bottom: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .movie-item:hover {
            background: rgba(255, 51, 102, 0.1);
            transform: translateX(10px);
        }
        
        .movie-item img {
            width: 80px;
            height: 120px;
            object-fit: cover;
            border-radius: 8px;
            border: 2px solid #FF3366;
        }
        
        .movie-info {
            flex: 1;
        }
        
        .movie-actions {
            display: flex;
            gap: 0.5rem;
        }
        
        .movie-actions button {
            padding: 0.5rem 1rem;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .movie-actions button:hover {
            background: #FF3366;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>
<body>
    <div class="admin-container">
        <div class="admin-header">
            <h1><i class="fas fa-cogs"></i> Panel de Administración</h1>
            <p>Gestiona tu sitio CineWeb desde aquí</p>
        </div>
        
        <div class="admin-nav">
            <button onclick="showAdminSection('agregar')" class="active">
                <i class="fas fa-plus"></i> Agregar Película
            </button>
            <button onclick="showAdminSection('editar')">
                <i class="fas fa-edit"></i> Editar Películas
            </button>
            <button onclick="showAdminSection('config')">
                <i class="fas fa-sliders-h"></i> Configuración
            </button>
            <button onclick="showAdminSection('backup')">
                <i class="fas fa-database"></i> Respaldo
            </button>
        </div>
        
        <!-- Sección: Agregar Película -->
        <div id="agregar" class="admin-section active">
            <div class="admin-card">
                <h3><i class="fas fa-film"></i> Agregar Nueva Película</h3>
                <form id="addMovieForm" onsubmit="addNewMovie(event)">
                    <div class="form-group">
                        <label for="movieTitle">Título *</label>
                        <input type="text" id="movieTitle" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="movieDescription">Descripción *</label>
                        <textarea id="movieDescription" required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="movieGenre">Género *</label>
                        <select id="movieGenre" required>
                            <option value="">Seleccionar género</option>
                            <option value="accion">Acción</option>
                            <option value="drama">Drama</option>
                            <option value="comedia">Comedia</option>
                            <option value="ciencia-ficcion">Ciencia Ficción</option>
                            <option value="terror">Terror</option>
                            <option value="romance">Romance</option>
                            <option value="animacion">Animación</option>
                            <option value="fantasia">Fantasía</option>
                            <option value="documental">Documental</option>
                        </select>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                        <div class="form-group">
                            <label for="movieYear">Año *</label>
                            <input type="number" id="movieYear" min="1900" max="2024" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="movieRating">Calificación *</label>
                            <input type="text" id="movieRating" placeholder="8.5/10" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="movieDuration">Duración *</label>
                            <input type="text" id="movieDuration" placeholder="2h 30m" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="movieQuality">Calidad *</label>
                            <select id="movieQuality" required>
                                <option value="720p">720p</option>
                                <option value="1080p">1080p</option>
                                <option value="4K">4K</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="movieVideoUrl">URL del Video *</label>
                        <input type="url" id="movieVideoUrl" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="moviePoster">URL del Póster *</label>
                        <input type="url" id="moviePoster" required>
                        <small style="color: rgba(255,255,255,0.5);">Puedes usar: https://via.placeholder.com/300x450/333/fff?text=TITULO</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="movieDownloadUrl">URL de Descarga *</label>
                        <input type="url" id="movieDownloadUrl" required>
                    </div>
                    
                    <div style="display: flex; gap: 1rem; margin-top: 2rem;">
                        <button type="submit" class="btn-admin">
                            <i class="fas fa-save"></i> Guardar Película
                        </button>
                        <button type="button" class="btn-admin btn-secondary" onclick="previewMovie()">
                            <i class="fas fa-eye"></i> Vista Previa
                        </button>
                        <button type="reset" class="btn-admin" style="background: rgba(255,255,255,0.1);">
                            <i class="fas fa-redo"></i> Limpiar
                        </button>
                    </div>
                </form>
            </div>
        </div>
        
        <!-- Sección: Editar Películas -->
        <div id="editar" class="admin-section">
            <div class="admin-card">
                <h3><i class="fas fa-edit"></i> Gestionar Películas</h3>
                <div class="movies-list" id="moviesList">
                    <!-- Las películas se cargarán aquí -->
                </div>
            </div>
        </div>
        
        <!-- Sección: Configuración -->
        <div id="config" class="admin-section">
            <div class="admin-card">
                <h3><i class="fas fa-sliders-h"></i> Configuración del Sitio</h3>
                
                <div class="form-group">
                    <label for="siteName">Nombre del Sitio</label>
                    <input type="text" id="siteName" value="CineWeb Pro">
                </div>
                
                <div class="form-group">
                    <label for="telegramChannel">Canal de Telegram</label>
                    <input type="url" id="telegramChannel" value="https://t.me/cineweb_oficial">
                </div>
                
                <div class="form-group">
                    <label for="adminPassword">Contraseña de Administrador</label>
                    <input type="password" id="adminPassword" value="cineweb2024">
                </div>
                
                <div class="form-group">
                    <label for="defaultQuality">Calidad por Defecto</label>
                    <select id="defaultQuality">
                        <option value="720p">720p</option>
                        <option value="1080p" selected>1080p</option>
                        <option value="4K">4K</option>
                    </select>
                </div>
                
                <button class="btn-admin" onclick="saveConfig()">
                    <i class="fas fa-save"></i> Guardar Configuración
                </button>
            </div>
        </div>
        
        <!-- Sección: Respaldo -->
        <div id="backup" class="admin-section">
            <div class="admin-card">
                <h3><i class="fas fa-database"></i> Respaldo y Restauración</h3>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem; margin-top: 2rem;">
                    <div style="text-align: center;">
                        <div style="font-size: 3rem; color: #FF3366; margin-bottom: 1rem;">
                            <i class="fas fa-download"></i>
                        </div>
                        <h4>Exportar Datos</h4>
                        <p style="color: rgba(255,255,255,0.7); margin: 1rem 0;">
                            Descarga una copia de seguridad de todas las películas y configuraciones.
                        </p>
                        <button class="btn-admin" onclick="exportBackup()">
                            <i class="fas fa-file-export"></i> Exportar Respaldo
                        </button>
                    </div>
                    
                    <div style="text-align: center;">
                        <div style="font-size: 3rem; color: #00D4FF; margin-bottom: 1rem;">
                            <i class="fas fa-upload"></i>
                        </div>
                        <h4>Importar Datos</h4>
                        <p style="color: rgba(255,255,255,0.7); margin: 1rem 0;">
                            Restaura desde un archivo de respaldo anterior.
                        </p>
                        <button class="btn-admin btn-secondary" onclick="importBackup()">
                            <i class="fas fa-file-import"></i> Importar Respaldo
                        </button>
                    </div>
                </div>
                
                <div style="margin-top: 3rem; padding-top: 2rem; border-top: 1px solid rgba(255,255,255,0.1);">
                    <h4>Estadísticas del Sistema</h4>
                    <div id="systemStats" style="color: rgba(255,255,255,0.7); margin-top: 1rem;">
                        <!-- Las estadísticas se cargarán aquí -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Cargar películas desde localStorage
        let peliculas = JSON.parse(localStorage.getItem('cineweb_peliculas')) || [];
        
        function showAdminSection(sectionId) {
            // Ocultar todas las secciones
            document.querySelectorAll('.admin-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Remover activo de todos los botones
            document.querySelectorAll('.admin-nav button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Mostrar sección seleccionada
            document.getElementById(sectionId).classList.add('active');
            
            // Marcar botón como activo
            event.target.classList.add('active');
            
            // Si es la sección de editar, cargar películas
            if (sectionId === 'editar') {
                loadMoviesList();
            }
            
            // Si es la sección de respaldo, cargar estadísticas
            if (sectionId === 'backup') {
                loadSystemStats();
            }
        }
        
        function addNewMovie(event) {
            event.preventDefault();
            
            const newMovie = {
                id: Date.now(),
                title: document.getElementById('movieTitle').value,
                description: document.getElementById('movieDescription').value,
                genre: document.getElementById('movieGenre').value,
                year: document.getElementById('movieYear').value,
                rating: document.getElementById('movieRating').value,
                duration: document.getElementById('movieDuration').value,
                videoUrl: document.getElementById('movieVideoUrl').value,
                poster: document.getElementById('moviePoster').value,
                downloadUrl: document.getElementById('movieDownloadUrl').value,
                quality: document.getElementById('movieQuality').value,
                director: "Director",
                actors: "Actores principales",
                language: "Español",
                size: "1.5 GB",
                addedDate: new Date().toISOString().split('T')[0],
                views: 0,
                downloads: 0,
                isFeatured: false,
                subtitles: ["Español"],
                trailer: ""
            };
            
            peliculas.push(newMovie);
            localStorage.setItem('cineweb_peliculas', JSON.stringify(peliculas));
            
            alert('¡Película agregada exitosamente!');
            document.getElementById('addMovieForm').reset();
            
            // Mostrar en consola para copiar
            console.log('Película agregada:', JSON.stringify(newMovie, null, 2));
        }
        
        function previewMovie() {
            const title = document.getElementById('movieTitle').value;
            const poster = document.getElementById('moviePoster').value;
            
            if (!title || !poster) {
                alert('Completa al menos el título y el póster para ver la vista previa');
                return;
            }
            
            const preview = `
                <div style="text-align: center; padding: 2rem;">
                    <h3>Vista Previa</h3>
                    <img src="${poster}" 
                         alt="${title}" 
                         style="width: 200px; height: 300px; object-fit: cover; border-radius: 12px; margin: 1rem 0; border: 3px solid #FF3366;">
                    <h4>${title}</h4>
                    <p style="color: rgba(255,255,255,0.7); margin-top: 0.5rem;">
                        Esta es cómo se verá la película en el catálogo
                    </p>
                </div>
            `;
            
            showModal('Vista Previa', preview);
        }
        
        function loadMoviesList() {
            const moviesList = document.getElementById('moviesList');
            moviesList.innerHTML = '';
            
            peliculas.forEach((movie, index) => {
                const movieItem = document.createElement('div');
                movieItem.className = 'movie-item';
                movieItem.innerHTML = `
                    <img src="${movie.poster}" alt="${movie.title}"
                         onerror="this.src='https://via.placeholder.com/80x120/333/fff?text=+'">
                    <div class="movie-info">
                        <h4>${movie.title}</h4>
                        <p style="color: rgba(255,255,255,0.7); font-size: 0.9rem; margin: 0.3rem 0;">
                            ${movie.year} • ${movie.genre} • ${movie.rating}
                        </p>
                        <p style="color: rgba(255,255,255,0.5); font-size: 0.8rem;">
                            Descargas: ${movie.downloads || 0} | Vistas: ${movie.views || 0}
                        </p>
                    </div>
                    <div class="movie-actions">
                        <button onclick="editMovie(${index})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button onclick="deleteMovie(${index})" style="background: #FF3333;">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                moviesList.appendChild(movieItem);
            });
        }
        
        function editMovie(index) {
            const movie = peliculas[index];
            
            const editForm = `
                <div style="padding: 2rem;">
                    <h3 style="margin-bottom: 1.5rem; color: #FF3366;">Editar: ${movie.title}</h3>
                    <div class="form-group">
                        <label for="editTitle">Título</label>
                        <input type="text" id="editTitle" value="${movie.title}">
                    </div>
                    <div class="form-group">
                        <label for="editDescription">Descripción</label>
                        <textarea id="editDescription">${movie.description}</textarea>
                    </div>
                    <div style="display: flex; gap: 1rem; margin-top: 2rem;">
                        <button onclick="saveMovieEdit(${index})" class="btn-admin">
                            <i class="fas fa-save"></i> Guardar Cambios
                        </button>
                        <button onclick="closeModal()" class="btn-admin" style="background: rgba(255,255,255,0.1);">
                            <i class="fas fa-times"></i> Cancelar
                        </button>
                    </div>
                </div>
            `;
            
            showModal('Editar Película', editForm);
        }
        
        function saveMovieEdit(index) {
            const movie = peliculas[index];
            movie.title = document.getElementById('editTitle').value;
            movie.description = document.getElementById('editDescription').value;
            
            localStorage.setItem('cineweb_peliculas', JSON.stringify(peliculas));
            closeModal();
            loadMoviesList();
            alert('¡Cambios guardados exitosamente!');
        }
        
        function deleteMovie(index) {
            if (confirm('¿Estás seguro de que quieres eliminar esta película?')) {
                peliculas.splice(index, 1);
                localStorage.setItem('cineweb_peliculas', JSON.stringify(peliculas));
                loadMoviesList();
                alert('Película eliminada');
            }
        }
        
        function saveConfig() {
            const config = {
                siteName: document.getElementById('siteName').value,
                telegramChannel: document.getElementById('telegramChannel').value,
                adminPassword: document.getElementById('adminPassword').value,
                defaultQuality: document.getElementById('defaultQuality').value
            };
            
            localStorage.setItem('cineweb_config', JSON.stringify(config));
            alert('Configuración guardada');
        }
        
        function exportBackup() {
            const data = {
                peliculas: peliculas,
                config: JSON.parse(localStorage.getItem('cineweb_config') || '{}'),
                downloads: JSON.parse(localStorage.getItem('cineweb_downloads') || '[]'),
                timestamp: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `cineweb_backup_${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            alert('Respaldo exportado exitosamente');
        }
        
        function importBackup() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            
            input.onchange = (e) => {
                const file = e.target.files[0];
                const reader = new FileReader();
                
                reader.onload = (event) => {
                    try {
                        const data = JSON.parse(event.target.result);
                        
                        if (confirm('¿Estás seguro de que quieres importar este respaldo? Esto sobrescribirá todos los datos actuales.')) {
                            if (data.peliculas) {
                                localStorage.setItem('cineweb_peliculas', JSON.stringify(data.peliculas));
                            }
                            if (data.config) {
                                localStorage.setItem('cineweb_config', JSON.stringify(data.config));
                            }
                            if (data.downloads) {
                                localStorage.setItem('cineweb_downloads', JSON.stringify(data.downloads));
                            }
                            
                            alert('¡Respaldo importado exitosamente! La página se recargará.');
                            location.reload();
                        }
                    } catch (error) {
                        alert('Error al importar el respaldo. Asegúrate de que el archivo sea válido.');
                    }
                };
                
                reader.readAsText(file);
            };
            
            input.click();
        }
        
        function loadSystemStats() {
            const statsDiv = document.getElementById('systemStats');
            const totalMovies = peliculas.length;
            const totalSize = peliculas.reduce((sum, m) => sum + (parseFloat(m.size) || 0), 0);
            const totalDownloads = peliculas.reduce((sum, m) => sum + (m.downloads || 0), 0);
            
            const genres = {};
            peliculas.forEach(movie => {
                genres[movie.genre] = (genres[movie.genre] || 0) + 1;
            });
            const popularGenre = Object.keys(genres).reduce((a, b) => genres[a] > genres[b] ? a : b, 'Ninguno');
            
            statsDiv.innerHTML = `
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem;">
                    <div>
                        <strong>Películas:</strong> ${totalMovies}
                    </div>
                    <div>
                        <strong>Espacio total:</strong> ${totalSize.toFixed(1)} GB
                    </div>
                    <div>
                        <strong>Descargas totales:</strong> ${totalDownloads}
                    </div>
                    <div>
                        <strong>Género popular:</strong> ${popularGenre}
                    </div>
                    <div>
                        <strong>Última actualización:</strong> ${new Date().toLocaleDateString()}
                    </div>
                    <div>
                        <strong>Versión:</strong> 2.0.0
                    </div>
                </div>
            `;
        }
        
        function showModal(title, content) {
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.9);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 10000;
                padding: 2rem;
            `;
            
            modal.innerHTML = `
                <div style="background: rgba(26,26,26,0.95); border-radius: 16px; max-width: 600px; width: 100%; max-height: 80vh; overflow-y: auto; position: relative;">
                    <button onclick="this.parentElement.parentElement.remove()" style="position: absolute; top: 20px; right: 20px; background: #FF3366; color: white; border: none; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; font-size: 1.5rem;">×</button>
                    <div style="padding: 3rem 2rem 2rem;">
                        <h2 style="margin-bottom: 1.5rem; color: #FF3366;">${title}</h2>
                        ${content}
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }
        
        function closeModal() {
            const modal = document.querySelector('div[style*="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9);"]');
            if (modal) modal.remove();
        }
        
        // Cargar configuración al iniciar
        document.addEventListener('DOMContentLoaded', () => {
            const savedConfig = JSON.parse(localStorage.getItem('cineweb_config') || '{}');
            if (savedConfig.siteName) {
                document.getElementById('siteName').value = savedConfig.siteName;
            }
            if (savedConfig.telegramChannel) {
                document.getElementById('telegramChannel').value = savedConfig.telegramChannel;
            }
            if (savedConfig.adminPassword) {
                document.getElementById('adminPassword').value = savedConfig.adminPassword;
            }
            if (savedConfig.defaultQuality) {
                document.getElementById('defaultQuality').value = savedConfig.defaultQuality;
            }
            
            loadMoviesList();
        });
    </script>
</body>
</html>
